<div class="card custom-card h-100">
  <!-- Card Header -->
  <div class="card-header">
    <div class="d-flex align-items-center w-100">
      <div class="me-2">
        <span class="avatar avatar-rounded">
          <img [src]="avatar()" alt="avatar" />
        </span>
      </div>

      <div class="flex-grow-1">
        <div class="d-flex align-items-center gap-2">
          <span class="fs-15 fw-medium">{{ name() }}</span>
          <span class="badge" [ngClass]="estadoClass()">
            {{ estadoActivacion() }}
          </span>
        </div>
        <p class="mb-0 text-muted fs-11">
          {{ categoria() }} · {{ nombreEmpresa() }}
        </p>
      </div>

      <div class="dropdown ms-auto" ngbDropdown>
        <a
          href="javascript:void(0);"
          ngbDropdownToggle
          class="btn btn-icon btn-sm btn-light no-caret"
        >
          <i class="fe fe-more-vertical"></i>
        </a>
        <ul class="dropdown-menu" ngbDropdownMenu>
          <li>
            <a class="dropdown-item" ngbDropdownItem (click)="onEdit()"
              >Editar</a
            >
          </li>
          <li>
            <a class="dropdown-item" ngbDropdownItem (click)="onTest()"
              >Probar</a
            >
          </li>
          <li>
            <a
              class="dropdown-item text-danger"
              ngbDropdownItem
              (click)="onDisable()"
              >Desactivar</a
            >
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Card Body -->
  <div class="card-body">
    <div class="d-flex flex-column gap-2 fs-13">
      <div class="d-flex align-items-center gap-2">
        <i class="fe fe-globe text-muted"></i>
        <a [href]="sitioWeb()" target="_blank" class="text-truncate">
          {{ sitioWeb() }}
        </a>
      </div>

      <div class="d-flex align-items-center gap-2">
        <i class="fe fe-cpu text-muted"></i>
        <span>Modelo: {{ openaiModel() }}</span>
      </div>

      <div class="d-flex align-items-center gap-2">
        <i class="fe fe-droplet text-muted"></i>
        <span>Color: </span>
        <span class="color-preview" [style.background]="color()"> </span>
      </div>
      <div class="d-flex align-items-center gap-2 bg-light p-2 rounded">
        <i class="ri-key-2-line text-primary"></i>
        <div class="input-group input-group-sm" style="width: 400px">
          <input
            [type]="isKeyVisible ? 'text' : 'password'"
            [value]="apiKey()"
            class="form-control form-control-sm border-end-0"
            [readonly]="true"
            id="apiKeyInput"
            #apiKeyInput
          />
          <button
            class="btn btn-outline-secondary border"
            type="button"
            (click)="toggleKeyVisibility()"
            [title]="isKeyVisible ? 'Ocultar API Key' : 'Mostrar API Key'"
          >
            <i [class]="isKeyVisible ? 'ri-eye-off-line' : 'ri-eye-line'"></i>
          </button>
          <button
            class="btn btn-outline-primary border"
            type="button"
            (click)="copyToClipboard(apiKeyInput)"
            title="Copiar al portapapeles"
          >
            <i class="ri-clipboard-line"></i>
          </button>
        </div>
        @if (copied) {
          <small class="text-muted ms-2" style="font-size: 0.8rem">
            <i class="ri-check-line text-success"></i> ¡Copiado!
          </small>
        }
      </div>
    </div>
  </div>

  <!-- Card Footer -->
  <div class="card-footer">
    <div
      class="d-flex justify-content-between align-items-center flex-wrap gap-2"
    >
      <span class="fs-12 text-muted">
        Creado el {{ createdAt() | date:'dd MMM yyyy' }}
      </span>
      <span class="badge" [ngClass]="statusClass()"> {{ status() }} </span>
    </div>
  </div>
</div>
