import{a as u,b as O}from"./chunk-FMBEFGB3.js";import"./chunk-4AUZCU3R.js";import{c as $}from"./chunk-2D66LXFZ.js";import{E as B,F as G,G as K,h as U,j as m,m as N,n as D,t as L,x as T,y as H}from"./chunk-42GC3H2R.js";import{Ad as E,Cb as d,Db as t,Eb as i,Fb as l,Id as A,Jd as j,Md as I,Tb as g,Wa as s,Wb as P,ba as c,e as y,eb as p,ia as S,ib as x,ic as b,jc as o,kc as R,ma as C,uc as v,wb as k,wc as M,xb as _,xc as w,zd as F}from"./chunk-DT3HLPPQ.js";import"./chunk-2EBTC7QX.js";import"./chunk-VB56BUGO.js";var h=class a{constructor(e){this.http=e;localStorage.getItem(this.tokenKey)&&this.fetchUser().subscribe()}apiUrl="http://localhost:8000/api/auth";tokenKey="auth_token";currentUserSubject=new y(null);currentUser$=this.currentUserSubject.asObservable();register(e){return this.http.post(`${this.apiUrl}/register`,e).pipe(c(r=>this.handleAuthResponse(r)))}login(e){return this.http.post(`${this.apiUrl}/login`,e).pipe(c(r=>this.handleAuthResponse(r)))}logout(){let e=this.getAuthHeaders();return this.http.post(`${this.apiUrl}/logout`,{},{headers:e}).pipe(c(()=>{localStorage.removeItem(this.tokenKey),this.currentUserSubject.next(null)}))}fetchUser(){let e=this.getAuthHeaders();return this.http.get(`${this.apiUrl}/user`,{headers:e}).pipe(c(r=>this.currentUserSubject.next(r)))}getAuthHeaders(){let e=localStorage.getItem(this.tokenKey);return new F({Authorization:`Bearer ${e}`})}handleAuthResponse(e){localStorage.setItem(this.tokenKey,e.token),this.currentUserSubject.next(e.user)}isLoggedIn(){return!!localStorage.getItem(this.tokenKey)}static \u0275fac=function(r){return new(r||a)(C(E))};static \u0275prov=S({token:a,factory:a.\u0275fac,providedIn:"root"})};var Y=()=>["/dashboards/sales"],J=()=>["/auth/login"];function Q(a,e){if(a&1&&(t(0,"p",8),o(1),i()),a&2){let r=P();s(),R(r.errorMessage)}}var q=class a{constructor(e,r,n,f){this.fb=e;this.authService=r;this.router=n;this.toastr=f;document.body.classList.add("authentication-background"),this.registerForm=this.fb.group({name:["",[m.required]],email:["",[m.required,m.email]],password:["",[m.required,m.minLength(6)]],password_confirmation:["",[m.required]]})}registerForm;loading=!1;errorMessage="";onSubmit(){if(this.registerForm.invalid){this.errorMessage="Por favor completa todos los campos.";return}this.loading=!0,this.errorMessage="",this.authService.register(this.registerForm.value).subscribe({next:e=>{console.log("Usuario registrado:",e),this.router.navigate(["/dashboards/sales"]),this.toastr.success("login successful","Vyzor",{timeOut:3e3,positionClass:"toast-top-right"})},error:e=>{this.errorMessage=e.error?.message||"Error al registrarse",this.loading=!1}})}ngOnDestroy(){document.body.classList.remove("authentication-background")}showPassword=!1;showPassword1=!1;toggleClass="off-line";toggleClass1="off-line";createpassword(){this.showPassword=!this.showPassword,this.toggleClass==="off-line"?this.toggleClass="line":this.toggleClass="off-line"}createpassword1(){this.showPassword1=!this.showPassword1,this.toggleClass1==="off-line"?this.toggleClass1="line":this.toggleClass1="off-line"}static \u0275fac=function(r){return new(r||a)(p(B),p(h),p(A),p(u))};static \u0275cmp=x({type:a,selectors:[["app-register-page"]],features:[M([{provide:u,useClass:u}])],decls:47,vars:14,consts:[[1,"authentication-basic-background"],["src","./assets/images/media/backgrounds/9.png","alt",""],[1,"container"],[1,"row","justify-content-center","align-items-center","authentication","authentication-basic","h-100"],[1,"col-xxl-4","col-xl-5","col-lg-6","col-md-6","col-sm-8","col-12"],[1,"card","custom-card","border-0","my-4"],[1,"card-body","p-5"],[3,"ngSubmit","formGroup"],[1,"text-danger"],[1,"mb-4"],[1,"d-flex","justify-content-center",3,"routerLink"],["src","./assets/images/logos/kaica.png","alt","logo",1,"desktop-dark"],[1,"mb-1","fw-semibold"],[1,"mb-4","text-muted","fw-normal"],[1,"row","gy-3"],[1,"col-xl-12"],["for","signin-username",1,"form-label","text-default"],["type","text","id","signin-username","placeholder","Ingrese su Nombre","formControlName","name",1,"form-control"],["for","signin-email",1,"form-label","text-default"],["type","text","id","signin-email","placeholder","Enter Email","formControlName","email",1,"form-control"],[1,"col-xl-12","mb-2"],["for","signin-password",1,"form-label","text-default","d-block"],[1,"position-relative"],["autocomplete","","id","signin-password","placeholder","Enter Password","type","password","formControlName","password",1,"form-control",3,"type"],["href","javascript:void(0);","id","button-addon2",1,"show-password-button","text-muted",3,"click"],["for","signin-confirm-password",1,"form-label","text-default","d-block"],["autocomplete","","id","signin-confirm-password","placeholder","Enter Password","type","password","formControlName","password_confirmation",1,"form-control",3,"type"],[1,"d-grid","mt-3"],["type","submit",1,"btn","btn-primary"],[1,"text-center","mt-3","fw-medium"],[1,"text-primary",3,"routerLink"]],template:function(r,n){r&1&&(t(0,"div",0),l(1,"img",1),i(),t(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"form",7),g("ngSubmit",function(){return n.onSubmit()}),k(8,Q,2,1,"p",8),t(9,"div",9)(10,"a",10),l(11,"img",11),i()(),t(12,"div")(13,"h4",12),o(14,"Registrate"),i(),t(15,"p",13),o(16," \xA1\xDAnete a nosotros creando una cuenta gratuita! "),i()(),t(17,"div",14)(18,"div",15)(19,"label",16),o(20,"Nombre"),i(),l(21,"input",17),i(),t(22,"div",15)(23,"label",18),o(24,"Email"),i(),l(25,"input",19),i(),t(26,"div",20)(27,"label",21),o(28,"Contrase\xF1a"),i(),t(29,"div",22),l(30,"input",23),t(31,"a",24),g("click",function(){return n.createpassword()}),l(32,"i"),i()()(),t(33,"div",20)(34,"label",25),o(35,"Confirme su Contrase\xF1a"),i(),t(36,"div",22),l(37,"input",26),t(38,"a",24),g("click",function(){return n.createpassword1()}),l(39,"i"),i()()()(),t(40,"div",27)(41,"button",28),o(42,"Registrarse"),i()(),t(43,"div",29),o(44," \xBFYa tienes una cuenta? "),t(45,"a",30),o(46,"Iniciar sesi\xF3n"),i()()()()()()()()),r&2&&(s(7),d("formGroup",n.registerForm),s(),_(n.errorMessage?8:-1),s(2),d("routerLink",w(12,Y)),s(20),d("type",n.showPassword?"text":"password"),s(2),b(v("ri-eye-",n.toggleClass," align-middle")),s(5),d("type",n.showPassword1?"text":"password"),s(2),b(v("ri-eye-",n.toggleClass1," align-middle")),s(6),d("routerLink",w(13,J)))},dependencies:[I,j,$,G,L,U,N,D,K,T,H,O],styles:[".btn-main-primary{color:#fff!important;background-color:#59c9f9!important;border-color:#59c9f9!important}.main-signin-header[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{border-width:1px}.firebase-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:28px;height:28px}.main-signin-header[_ngcontent-%COMP%]   .nav-tabs[_ngcontent-%COMP%]{width:95px;justify-content:center;margin:0 auto;padding:4px;border-radius:0;border:1px solid #e4e3ef}.main-signin-header[_ngcontent-%COMP%]   .firebase-img[_ngcontent-%COMP%]{padding:7px}.firebase-img.nav-link.active[_ngcontent-%COMP%]{background-color:rgba(var(--primary-rgb),.05)!important}"]})};export{q as RegisterPage};
